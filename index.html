<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>致宝宝的一封信</title>
<link type="text/css" rel="stylesheet" href="renxi/default.css">
<script src="renxi/jquery.min.js"></script>
<script src="renxi/jscex.min.js"></script>
<script src="renxi/jscex-parser.js"></script>
<script src="renxi/jscex-jit.js"></script>
<script src="renxi/jscex-builderbase.min.js"></script>
<script src="renxi/jscex-async.min.js"></script>
<script src="renxi/jscex-async-powerpack.min.js"></script>
<script src="renxi/functions.js" charset="utf-8"></script>
<script src="renxi/love.js" charset="utf-8"></script>
<style>
body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    background-color: #fff;
}

.letter-content {
    max-width: 2400px; /* 扩大容器宽度以增加每行字数 */
    margin: 0 auto;
    padding: 20px;
    font-family: '楷体';
}

.section-title {
    font-size: 1.2em;
    font-weight: bold;
    margin-top: 1em;
    text-align: center;
    font-family: '黑体';
}

.large-text {
    font-size: 1.5em;
    text-indent: 0; /* 首行不缩进 */
    font-family: 'KaiTi', '楷体', 'STKaiti', 'Kaiti SC', 'Kaiti TC', serif; /* 使用楷书字体 */
}

.different-section {
    max-width: 2400px; /* 扩大容器宽度以增加每行字数 */
    margin-top: 10em; /* 下移10行 */
    column-count: 2; /* 设置为两栏布局 */
    column-gap: 40px; /* 栏间距 */
    width: 200%;
    font-size: 1em; /* 保持字体大小不变 */
    line-height: 1.5;
    text-indent: 2em; /* 首行缩进两个字符 */
    font-family: 'KaiTi', '楷体', 'STKaiti', 'Kaiti SC', 'Kaiti TC', serif; /* 使用楷书字体 */

}

p {
    text-indent: 2em; /* 首行缩进两个字符 */
}

#clock-box {
    text-align: center;
    margin-top: 0; /* 上移5行 */
    margin-bottom: 5em;
}

#touch-area {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5em;
    cursor: pointer;
    z-index: 9999; /* 确保在最上层 */
}
</style>
</head>
<body>
<audio id="background-audio" loop>
  <source src="音乐.mp3" type="audio/mp3">
  您的浏览器不支持音频元素。
</audio>

<!-- 触摸区域 -->
<div id="touch-area">
  触摸屏幕以播放音乐
</div>

<div id="main">
  <div id="error" style="display: none;">本页面采用HTML5编辑，目前您的浏览器无法显示，请换成谷歌(Chrome)或者火狐(Firefox)浏览器，或者其他游览器的最新版本。</div>
  <div id="wrap">
    <div id="text" class="letter-content">
      <div id="code"> 
        <p class="large-text">宝宝，见字如面:</p>
        <p>每当谈及与你的感情的时候，总是千头万绪，但又不知所言。恰逢咱们的纪念日，正好言其意、抒其情。</p>
        <p class="section-title">缘分的开始</p>
        <p>斯人如彩虹，遇上方有知。我们的缘分起于一次意想不到的联谊，一张毫不起眼的照片，一次意料之外的相遇。初见你，我准备了很久，却依旧慌了神，举着露在半空的手，直勾勾的看着你的眼，露出傻傻的笑，愣在原地。那是什么样的眼睛呢？清澈而温柔，灵动又活泼，如春风拂面般温暖平和，又像秋日里漫山遍野的金黄安静而热烈。这世间，有的人暗淡浅薄，有的人光芒万丈，有的人败絮藏心，而当你无意邂逅，一个灿若红霞的人，从此之后，也便只得她一个。那一刻，是你；此后，也便只能是你。</p>
        <div class="different-section">
          <p class="section-title">我们的不同与契合</p>
          <p>宝宝，你是我缺失的拼图，我是你寻觅的角落。你喜欢遇事分享，而我却总是藏事不说；你喜好活在当下，而我总是从长计议；你总是平易近人，而我却是生人勿近；你阳光开朗、热情大方，但内心脆弱敏感、优柔寡断，而我果敢坚毅、自信刚强，却孤傲偏执、不善表达。我们不是泰戈尔笔下的飞鸟与鱼，隔着世界上最遥远的距离，而像白日和黑夜，彼此交织，相互依赖又要独自坚强。白日追梦逐光而动，黑夜寻星不止前行，我们都在追求着美好的拥有彼此的将来。</p>
          <p class="section-title">你的笑与泪</p>
          <p>宝宝，我见过你笑，那是一对俏皮的兔牙。是你在初见时礼貌又温柔的那对，是你在偷亲我时害羞又期待的那对，是你在收到鲜花时开心而满足的那对，是我一闭眼就能想到的你笑着的那对。浩瀚星河，星辰满天，目之所及，皆是你。</p>
          <p>宝宝，我见过你哭，那是一颗明亮的泪珠。是许久不见时默默流下委屈又难过的那颗，是分别时紧紧抱住而滴下的不舍而又惜别的那颗，是鼓起勇气说出秘密洒出的释然而又解脱的那颗，是我一想起就热泪盈眶的那颗。繁华落尽，灯火阑珊，柳暗花明，依旧是你。</p>
          <p class="section-title">过往与未来</p>
          <p>宝宝，我们之间经历了很多事。开心的、难过的、期待的、厌恶的、幼稚的、迷茫的，再多已是过往，取其美好即可。仓央嘉措说过，世间事，除了生死，哪一件不是闲事？悟已往之不谏，知来者之可追。日后诸事纷扰，我心依旧赤诚。</p>
          <p>宝宝，可曾想过老时的样子？当你老了，头发花白，睡意沉沉，我们一起倦坐在炉边，回首往事。有多少人爱慕你年轻时的美丽，真心或是假意？惟独一人曾爱你那纯粹的心，爱你哀戚的脸上岁月的留痕。爱情从未逝去，它步上群山，藏在了悠悠的岁月里。</p>
          <p>宝宝，请相信我们的相遇，因为在茫茫人海中相遇，本就是轮回的期冀；请相信我们的爱情，因为她如夏花般绚烂，如秋夜般静美，本就是生命的奇迹！</p>
        </div>
      </div>
    </div>
    <div id="clock-box"> <span class="STYLE1"></span><font color="#33CC00">亲爱的宝宝，我喜欢你</font> <span class="STYLE1">已经是……</span>
      <div id="clock"></div>
    </div>
    <canvas id="canvas" width="1100" height="680"></canvas>
  </div>
</div>
<script>
    // 添加触摸事件来播放音乐
    document.getElementById('touch-area').addEventListener('touchstart', function() {
        var audio = document.getElementById('background-audio');
        audio.play();
        this.style.display = 'none'; // 隐藏触摸区域
    });

    (function(){
        var canvas = $('#canvas');
		
        if (!canvas[0].getContext) {
            $("#error").show();
            return false;        }

        var width = canvas.width();
        var height = canvas.height();        
        canvas.attr("width", width);
        canvas.attr("height", height);
        var opts = {
            seed: {
                x: width / 2 - 20,
                color: "rgb(190, 26, 37)",
                scale: 2
            },
            branch: [
                [535, 680, 570, 250, 500, 200, 30, 100, [
                    [540, 500, 455, 417, 340, 400, 13, 100, [
                        [450, 435, 434, 430, 394, 395, 2, 40]
                    ]],
                    [550, 445, 600, 356, 680, 345, 12, 100, [
                        [578, 400, 648, 409, 661, 426, 3, 80]
                    ]],
                    [539, 281, 537, 248, 534, 217, 3, 40],
                    [546, 397, 413, 247, 328, 244, 9, 80, [
                        [427, 286, 383, 253, 371, 205, 2, 40],
                        [498, 345, 435, 315, 395, 330, 4, 60]
                    ]],
                    [546, 357, 608, 252, 678, 221, 6, 100, [
                        [590, 293, 646, 277, 648, 271, 2, 80]
                    ]]
                ]] 
            ],
            bloom: {
                num: 700,
                width: 1080,
                height: 650,
            },
            footer: {
                width: 1200,
                height: 5,
                speed: 10,
            }
        }

        var tree = new Tree(canvas[0], width, height, opts);
        var seed = tree.seed;
        var foot = tree.footer;
        var hold = 1;

        canvas.click(function(e) {
            var offset = canvas.offset(), x, y;
            x = e.pageX - offset.left;
            y = e.pageY - offset.top;
            if (seed.hover(x, y)) {
                hold = 0; 
                canvas.unbind("click");
                canvas.unbind("mousemove");
                canvas.removeClass('hand');
            }
        }).mousemove(function(e){
            var offset = canvas.offset(), x, y;
            x = e.pageX - offset.left;
            y = e.pageY - offset.top;
            canvas.toggleClass('hand', seed.hover(x, y));
        });

        var seedAnimate = eval(Jscex.compile("async", function () {
            seed.draw();
            while (hold) {
                $await(Jscex.Async.sleep(10));
            }
            while (seed.canScale()) {
                seed.scale(0.95);
                $await(Jscex.Async.sleep(10));
            }
            while (seed.canMove()) {
                seed.move(0, 2);
                foot.draw();
                $await(Jscex.Async.sleep(10));
            }
        }));

        var growAnimate = eval(Jscex.compile("async", function () {
            do {
    	        tree.grow();
                $await(Jscex.Async.sleep(10));
            } while (tree.canGrow());
        }));

        var flowAnimate = eval(Jscex.compile("async", function () {
            do {
    	        tree.flower(2);
                $await(Jscex.Async.sleep(10));
            } while (tree.canFlower());
        }));

        var moveAnimate = eval(Jscex.compile("async", function () {
            tree.snapshot("p1", 240, 0, 610, 680);
            while (tree.move("p1", 500, 0)) {
                foot.draw();
                $await(Jscex.Async.sleep(10));
            }
            foot.draw();
            tree.snapshot("p2", 500, 0, 610, 680);

            // 会有闪烁不得意这样做, (＞﹏＜)
            canvas.parent().css("background", "url(" + tree.toDataURL('image/png') + ")");
            canvas.css("background", "#ffe");
            $await(Jscex.Async.sleep(300));
            canvas.css("background", "none");
        }));

        var jumpAnimate = eval(Jscex.compile("async", function () {
            var ctx = tree.ctx;
            while (true) {
                tree.ctx.clearRect(0, 0, width, height);
                tree.jump();
                foot.draw();
                $await(Jscex.Async.sleep(25));
            }
        }));

        var textAnimate = eval(Jscex.compile("async", function () {
		    var together = new Date();
		    together.setFullYear(2024, 8, 22);  // 月份是从0开始计数的，所以9月是8
		    together.setHours(11);
		    together.setMinutes(25);
		    together.setSeconds(0);
		    together.setMilliseconds(0);

		    $("#code").show().typewriter();
            $("#clock-box").fadeIn(500);
            while (true) {
                timeElapse(together);
                $await(Jscex.Async.sleep(1000));
            }
        }));

        var runAsync = eval(Jscex.compile("async", function () {
            $await(seedAnimate());
            $await(growAnimate());
            $await(flowAnimate());
            $await(moveAnimate());

            textAnimate().start();

            $await(jumpAnimate());
        }));

        runAsync().start();
    })();
    </script>

</body>
</html>
